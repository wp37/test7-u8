<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ezteach Quiz - Unit 8: Films</title>
    <meta name="description" content="B√†i ki·ªÉm tra tr·∫Øc nghi·ªám Unit 8: Films - Global Success 7">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 'inter': ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
        }

        .option-btn {
            transition: all 0.3s ease;
        }

        .option-btn:hover:not(.selected) {
            transform: translateX(8px);
            border-color: #6366f1;
            background-color: #eef2ff;
        }

        .option-btn.selected {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            color: white;
            border-color: transparent;
        }

        .progress-bar {
            background: linear-gradient(90deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
        }

        .score-circle {
            background: conic-gradient(#6366f1 var(--score-percent), #e5e7eb 0deg);
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: fall 3s linear forwards;
            pointer-events: none;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(720deg);
            }
        }

        .timer-warning {
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .reading-passage {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-left: 4px solid #0ea5e9;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.75rem;
            font-style: italic;
            line-height: 1.8;
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-slate-900 via-indigo-950 to-slate-900">
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="absolute top-20 left-10 w-72 h-72 bg-indigo-500/20 rounded-full blur-3xl animate-pulse"></div>
        <div class="absolute bottom-20 right-10 w-96 h-96 bg-purple-500/20 rounded-full blur-3xl animate-pulse"></div>
    </div>

    <div class="relative z-10 container mx-auto px-4 py-8 max-w-2xl">
        <header class="text-center mb-8">
            <div class="inline-flex items-center gap-3 bg-white/10 backdrop-blur-lg px-6 py-3 rounded-full mb-4">
                <span class="text-3xl">üé¨</span>
                <span class="text-white font-bold text-lg">Ezteach</span>
            </div>
            <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-2">
                Unit 8: <span
                    class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400">Films</span>
            </h1>
            <p class="text-indigo-200 text-sm">Global Success 7 - B√†i ki·ªÉm tra tr·∫Øc nghi·ªám</p>
        </header>

        <!-- Locked Screen -->
        <section id="lockedScreen" class="hidden">
            <div class="glass-card rounded-3xl shadow-2xl overflow-hidden">
                <div class="bg-gradient-to-br from-gray-600 to-gray-800 p-8 text-center">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-white/20 rounded-full mb-4">
                        <span class="text-4xl">üîí</span>
                    </div>
                    <h2 class="text-2xl font-bold text-white mb-2">B√†i ki·ªÉm tra ch∆∞a m·ªü</h2>
                    <p class="text-gray-200">Vui l√≤ng quay l·∫°i ƒë√∫ng gi·ªù</p>
                </div>
                <div class="p-8 text-center">
                    <div class="bg-indigo-50 rounded-2xl p-6 mb-6">
                        <div class="text-lg text-gray-600 mb-2">‚è∞ Th·ªùi gian m·ªü b√†i:</div>
                        <div class="text-3xl font-extrabold text-indigo-600 mb-2">19:20 - Th·ª© B·∫£y</div>
                        <div class="text-xl font-bold text-purple-600">07/02/2026</div>
                    </div>
                    <div id="countdownToOpen" class="text-gray-600">
                        <div class="text-sm mb-2">C√≤n l·∫°i:</div>
                        <div id="countdownDisplay" class="text-2xl font-bold text-indigo-600">--:--:--</div>
                    </div>
                    <div class="mt-6 p-4 bg-amber-50 border border-amber-200 rounded-xl">
                        <p class="text-amber-800 text-sm">
                            <span class="font-bold">‚ö†Ô∏è L∆∞u √Ω:</span> B√†i ki·ªÉm tra ch·ªâ m·ªü trong <strong>15 ph√∫t</strong>.
                            H√£y quay l·∫°i ƒë√∫ng gi·ªù!
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Expired Screen -->
        <section id="expiredScreen" class="hidden">
            <div class="glass-card rounded-3xl shadow-2xl overflow-hidden">
                <div class="bg-gradient-to-br from-red-500 to-red-700 p-8 text-center">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-white/20 rounded-full mb-4">
                        <span class="text-4xl">‚è∞</span>
                    </div>
                    <h2 class="text-2xl font-bold text-white mb-2">ƒê√£ h·∫øt th·ªùi gian</h2>
                    <p class="text-red-100">B√†i ki·ªÉm tra ƒë√£ ƒë√≥ng</p>
                </div>
                <div class="p-8 text-center">
                    <p class="text-gray-600 mb-4">Th·ªùi gian l√†m b√†i ƒë√£ k·∫øt th√∫c.</p>
                    <p class="text-gray-600">Vui l√≤ng li√™n h·ªá gi√°o vi√™n n·∫øu b·∫°n c√≥ l√Ω do ch√≠nh ƒë√°ng.</p>
                    <div class="mt-6 flex gap-3 justify-center">
                        <a href="https://zalo.me/0914666040"
                            class="px-6 py-3 bg-blue-500 text-white font-semibold rounded-xl hover:bg-blue-600 transition-all">üí¨
                            Li√™n h·ªá Zalo</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Start Screen -->
        <!-- Completed Screen (ƒë√£ ho√†n th√†nh) -->
        <section id="completedScreen" class="hidden">
            <div class="glass-card rounded-3xl shadow-2xl overflow-hidden">
                <div class="bg-gradient-to-br from-emerald-500 to-teal-600 p-8 text-center">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-white/20 rounded-full mb-4">
                        <span class="text-4xl">‚úÖ</span>
                    </div>
                    <h2 class="text-2xl font-bold text-white mb-2">B·∫°n ƒë√£ ho√†n th√†nh b√†i ki·ªÉm tra</h2>
                    <p class="text-emerald-100">M·ªói h·ªçc sinh ch·ªâ ƒë∆∞·ª£c l√†m b√†i 1 l·∫ßn</p>
                </div>
                <div class="p-8 text-center">
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4">
                        <p class="text-blue-800 text-sm">
                            üìã K·∫øt qu·∫£ c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n. Vui l√≤ng li√™n h·ªá gi√°o vi√™n n·∫øu c√≥ th·∫Øc m·∫Øc.
                        </p>
                    </div>
                    <div class="mt-6 flex gap-3 justify-center">
                        <a href="https://zalo.me/0914666040"
                            class="px-6 py-3 bg-blue-500 text-white font-semibold rounded-xl hover:bg-blue-600 transition-all">üí¨
                            Li√™n h·ªá Zalo</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Start Screen -->
        <section id="startScreen" class="hidden">
            <div class="glass-card rounded-3xl shadow-2xl overflow-hidden">
                <div class="gradient-bg p-8 text-center">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-white/20 rounded-full mb-4">
                        <span class="text-4xl">üé¨</span>
                    </div>
                    <h2 class="text-2xl font-bold text-white mb-2">S·∫µn s√†ng ki·ªÉm tra?</h2>
                    <p class="text-indigo-100">20 c√¢u h·ªèi ‚Ä¢ Kh√¥ng gi·ªõi h·∫°n th·ªùi gian</p>
                </div>
                <div class="p-8">
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="text-center p-4 bg-indigo-50 rounded-2xl">
                            <div class="text-2xl mb-1">üìù</div>
                            <div class="text-2xl font-bold text-indigo-600">20</div>
                            <div class="text-xs text-gray-500">C√¢u h·ªèi</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded-2xl">
                            <div class="text-2xl mb-1">‚è±Ô∏è</div>
                            <div class="text-2xl font-bold text-purple-600">‚àû</div>
                            <div class="text-xs text-gray-500">Kh√¥ng gi·ªõi h·∫°n</div>
                        </div>
                        <div class="text-center p-4 bg-pink-50 rounded-2xl">
                            <div class="text-2xl mb-1">üéØ</div>
                            <div class="text-2xl font-bold text-pink-600">10</div>
                            <div class="text-xs text-gray-500">ƒêi·ªÉm t·ªëi ƒëa</div>
                        </div>
                    </div>
                    <div class="bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6">
                        <p class="text-amber-800 text-sm">
                            <span class="font-bold">‚ö†Ô∏è L∆∞u √Ω:</span> B·∫°n ch·ªâ ƒë∆∞·ª£c l√†m b√†i ki·ªÉm tra <strong>1 l·∫ßn duy
                                nh·∫•t</strong>. ƒê√°p
                            √°n s·∫Ω ƒë∆∞·ª£c gi√°o vi√™n th√¥ng b√°o sau.
                        </p>
                    </div>
                    <form id="studentForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">üë§ H·ªç v√† t√™n h·ªçc sinh</label>
                            <input type="text" id="studentName" required
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none text-gray-700"
                                placeholder="Nh·∫≠p h·ªç v√† t√™n...">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">üè´ L·ªõp</label>
                            <input type="text" id="studentClass" required
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none text-gray-700"
                                placeholder="V√≠ d·ª•: 7A1">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">üì± S·ªë ƒëi·ªán tho·∫°i ph·ª• huynh
                                <span class="text-red-500">*</span></label>
                            <input type="tel" id="parentPhone" required pattern="[0-9]{10,11}"
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none text-gray-700"
                                placeholder="Nh·∫≠p SƒêT cha/m·∫π (VD: 0912345678)">
                            <p class="text-xs text-gray-500 mt-1">K·∫øt qu·∫£ s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn ph·ª• huynh ƒë·ªÉ x√°c nh·∫≠n</p>
                        </div>
                        <button type="submit"
                            class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] transition-all">
                            üöÄ B·∫Øt ƒë·∫ßu l√†m b√†i
                        </button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Quiz Screen -->
        <section id="quizScreen" class="hidden">
            <div class="glass-card rounded-2xl p-4 mb-4 shadow-lg">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl">‚è±Ô∏è</span>
                        <span class="text-gray-600 font-medium">Th·ªùi gian c√≤n l·∫°i:</span>
                    </div>
                    <div id="timerDisplay" class="text-2xl font-bold text-indigo-600">15:00</div>
                </div>
                <div class="mt-3 h-2 bg-gray-200 rounded-full overflow-hidden">
                    <div id="timerBar"
                        class="h-full bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full transition-all duration-1000"
                        style="width: 100%"></div>
                </div>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-6 shadow-lg">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold"
                            id="qNum">1</div>
                        <div>
                            <div class="text-sm text-gray-500">C√¢u h·ªèi</div>
                            <div class="font-bold text-gray-800"><span id="currentQ">1</span>/20</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-gray-500" id="dispName">H·ªçc sinh</div>
                        <div class="text-xs text-indigo-600 font-medium" id="dispClass">L·ªõp 7</div>
                    </div>
                </div>
                <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                    <div id="progressBar" class="h-full progress-bar rounded-full transition-all duration-500"
                        style="width: 5%"></div>
                </div>
            </div>

            <!-- Reading Passage (shown for questions 17-20) -->
            <div id="readingPassageContainer" class="hidden glass-card rounded-2xl p-4 mb-4 shadow-lg">
                <div class="text-sm font-semibold text-indigo-600 mb-2">üìñ ƒê·ªçc ƒëo·∫°n vƒÉn sau v√† tr·∫£ l·ªùi c√°c c√¢u h·ªèi
                    17-20:</div>
                <div class="reading-passage">
                    "Last week, Lan went to see the film 'The Last Hero'. It is a sci-fi film set in 2050.
                    <strong>Although</strong> Lan is not a fan of science fiction, she decided to watch it because her
                    favorite actor stars in it. The special effects were amazing, and the plot was gripping.
                    <strong>However</strong>, the film was a bit too long, lasting nearly three hours. Most people in
                    the cinema enjoyed it, but Lan felt quite tired at the end. She thinks it is a must-see for sci-fi
                    fans, but maybe not for everyone."
                </div>
            </div>

            <div class="glass-card rounded-3xl shadow-2xl overflow-hidden" id="questionCard">
                <div class="p-6 md:p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <div class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-2xl flex items-center justify-center text-white font-bold text-lg shadow-lg"
                            id="qBadge">1</div>
                        <p id="questionText"
                            class="text-lg md:text-xl font-semibold text-gray-800 leading-relaxed pt-2">Loading...</p>
                    </div>
                    <div id="optionsContainer" class="space-y-3"></div>
                </div>
                <div class="px-6 md:px-8 pb-6 md:pb-8">
                    <div class="flex gap-3">
                        <button id="prevBtn"
                            class="flex-1 py-3 px-6 bg-gray-100 text-gray-700 font-semibold rounded-xl hover:bg-gray-200 transition-all disabled:opacity-50"
                            disabled>‚Üê Tr∆∞·ªõc</button>
                        <button id="nextBtn"
                            class="flex-1 py-3 px-6 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-xl hover:shadow-lg transition-all">Ti·∫øp
                            ‚Üí</button>
                        <button id="submitBtn"
                            class="hidden flex-1 py-3 px-6 bg-gradient-to-r from-emerald-500 to-teal-500 text-white font-semibold rounded-xl hover:shadow-lg transition-all">‚úì
                            N·ªôp b√†i</button>
                    </div>
                </div>
            </div>

            <div class="glass-card rounded-2xl p-4 mt-6 shadow-lg">
                <div class="text-sm text-gray-500 mb-3 font-medium">ƒêi·ªÅu h∆∞·ªõng c√¢u h·ªèi:</div>
                <div id="questionNav" class="flex flex-wrap gap-2"></div>
            </div>
        </section>

        <!-- Result Screen -->
        <section id="resultScreen" class="hidden">
            <div class="glass-card rounded-3xl shadow-2xl overflow-hidden">
                <div id="resultHeader" class="p-8 text-center gradient-bg">
                    <div class="relative inline-block mb-4">
                        <div class="w-32 h-32 rounded-full score-circle flex items-center justify-center"
                            style="--score-percent: 0deg;">
                            <div class="w-28 h-28 bg-white rounded-full flex flex-col items-center justify-center">
                                <span id="scoreDisplay" class="text-4xl font-extrabold text-indigo-600">0</span>
                                <span class="text-gray-400 text-sm">/10 ƒëi·ªÉm</span>
                            </div>
                        </div>
                    </div>
                    <h2 id="resultTitle" class="text-2xl font-bold text-white mb-2">K·∫øt qu·∫£</h2>
                    <p id="resultMessage" class="text-indigo-100">ƒêang t√≠nh ƒëi·ªÉm...</p>
                </div>
                <div class="p-8">
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="text-center p-4 bg-emerald-50 rounded-2xl border-2 border-emerald-100">
                            <div class="text-2xl mb-1">‚úÖ</div>
                            <div id="correctCount" class="text-2xl font-bold text-emerald-600">0</div>
                            <div class="text-xs text-gray-500">ƒê√∫ng</div>
                        </div>
                        <div class="text-center p-4 bg-red-50 rounded-2xl border-2 border-red-100">
                            <div class="text-2xl mb-1">‚ùå</div>
                            <div id="incorrectCount" class="text-2xl font-bold text-red-500">0</div>
                            <div class="text-xs text-gray-500">Sai</div>
                        </div>
                        <div class="text-center p-4 bg-indigo-50 rounded-2xl border-2 border-indigo-100">
                            <div class="text-2xl mb-1">üìä</div>
                            <div id="percentDisplay" class="text-2xl font-bold text-indigo-600">0%</div>
                            <div class="text-xs text-gray-500">T·ª∑ l·ªá</div>
                        </div>
                    </div>
                    <div id="submitStatus" class="text-center mb-4 py-2 px-4 rounded-lg text-sm font-medium"></div>
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4">
                        <p class="text-blue-800 text-sm text-center">
                            üìã ƒê√°p √°n chi ti·∫øt s·∫Ω ƒë∆∞·ª£c gi√°o vi√™n th√¥ng b√°o sau bu·ªïi ki·ªÉm tra.
                        </p>
                    </div>
                    <div class="bg-emerald-50 border border-emerald-200 rounded-xl p-4 mb-4">
                        <p class="text-emerald-800 text-sm text-center">
                            üì± K·∫øt qu·∫£ ƒë√£ ƒë∆∞·ª£c g·ª≠i v·ªÅ s·ªë ƒëi·ªán tho·∫°i ph·ª• huynh: <strong id="resultPhone">---</strong>
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <footer class="text-center mt-8 text-indigo-300/60 text-sm">
            <p>¬© 2026 Ezteach - Th·∫ßy V√µ Ng·ªçc T√πng</p>
            <p class="mt-1">
                <a href="https://zalo.me/0914666040" class="hover:text-indigo-300">üí¨ Zalo</a>
                <span class="mx-2">‚Ä¢</span>
                <a href="https://facebook.com/vongoctungthcs" class="hover:text-indigo-300">üìò Facebook</a>
            </p>
        </footer>
    </div>

    <script>
        // ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
        // ‚ïë                     C·∫§U H√åNH B√ÄI KI·ªÇM TRA                      ‚ïë
        // ‚ïë        Unit 8: Films - Global Success 7                        ‚ïë
        // ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

        // ===== 1. GOOGLE SHEETS URL =====
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwQIsxeBoo5-tdHisvppQMA9s9nhBKXmf2cQtVQV6m8hprlPNT9llimKgYFAvg3C5V38g/exec';

        // ===== 2. TH·ªúI GIAN L√ÄM B√ÄI =====
        const QUIZ_TIME = 0; // 0 = kh√¥ng gi·ªõi h·∫°n th·ªùi gian
        const TIMER_ENABLED = false; // T·∫Øt timer

        // ===== 3. KH√ìA TH·ªúI GIAN L√ÄM B√ÄI =====
        const SCHEDULE_ENABLED = false; // T·∫Øt schedule - Quiz m·ªü m·ªçi l√∫c
        const OPEN_TIME = new Date('2026-02-07T19:20:00+07:00');
        const CLOSE_TIME = new Date('2026-02-07T19:35:00+07:00');

        // ===== 4. CH·ªà CHO L√ÄM 1 L·∫¶N =====
        const QUIZ_ID = 'quiz-unit8-films-v1'; // ID duy nh·∫•t cho quiz n√†y
        const ONE_TIME_ONLY = true; // Ch·ªâ cho l√†m 1 l·∫ßn

        // ===== 4. C√ÇU H·ªéI TR·∫ÆC NGHI·ªÜM - UNIT 8: FILMS =====
        const quizData = [
            // PH·∫¶N 1: VOCABULARY (T·ª™ V·ª∞NG) - C√¢u 1-8
            {
                id: 1,
                question: "I don't like watching __________ because they are too scary and they give me nightmares.",
                options: ["comedies", "documentaries", "horror films", "cartoons"],
                correct: 2
            },
            {
                id: 2,
                question: "The film was so __________ that I cried at the end.",
                options: ["funny", "moving", "boring", "violent"],
                correct: 1
            },
            {
                id: 3,
                question: "A __________ is a film that gives facts about a topic, such as animals, history, or science.",
                options: ["documentary", "fantasy", "thriller", "sci-fi"],
                correct: 0
            },
            {
                id: 4,
                question: "The film was extremely __________. I fell asleep in the middle of it.",
                options: ["gripping", "dull", "exciting", "frightening"],
                correct: 1
            },
            {
                id: 5,
                question: "Steven Spielberg is a famous film __________. He tells the actors what to do.",
                options: ["actor", "director", "critic", "writer"],
                correct: 1
            },
            {
                id: 6,
                question: "The plot of the movie was __________. I couldn't guess the ending.",
                options: ["predictable", "boring", "gripping", "childish"],
                correct: 2
            },
            {
                id: 7,
                question: "A __________ usually makes people laugh a lot.",
                options: ["thriller", "horror film", "comedy", "documentary"],
                correct: 2
            },
            {
                id: 8,
                question: "The __________ in the film was excellent. The actors performed very well.",
                options: ["plot", "acting", "setting", "soundtrack"],
                correct: 1
            },

            // PH·∫¶N 2: GRAMMAR (NG·ªÆ PH√ÅP - CONNECTORS) - C√¢u 9-16
            {
                id: 9,
                question: "__________ the film was long, it was very interesting.",
                options: ["Although", "However", "But", "So"],
                correct: 0
            },
            {
                id: 10,
                question: "The special effects were amazing. __________, the plot was weak.",
                options: ["Although", "However", "Because", "And"],
                correct: 1
            },
            {
                id: 11,
                question: "I wanted to see the film, __________ I was too tired.",
                options: ["however", "although", "but", "so"],
                correct: 2
            },
            {
                id: 12,
                question: "The weather was bad. __________, we decided to go to the cinema.",
                options: ["Although", "Nevertheless", "But", "Because"],
                correct: 1
            },
            {
                id: 13,
                question: "__________ the acting was good, I didn't enjoy the movie.",
                options: ["However", "But", "Although", "Nevertheless"],
                correct: 2
            },
            {
                id: 14,
                question: "The film received bad reviews. __________, it was a box office hit.",
                options: ["Although", "But", "However", "Because"],
                correct: 2
            },
            {
                id: 15,
                question: "__________ he is a fan of action movies, he didn't like this one.",
                options: ["However", "Although", "But", "Nevertheless"],
                correct: 1
            },
            {
                id: 16,
                question: "The plot was gripping. __________, the acting was a bit weak.",
                options: ["Although", "So", "Nevertheless", "Because"],
                correct: 2
            },

            // PH·∫¶N 3: READING COMPREHENSION (ƒê·ªåC HI·ªÇU) - C√¢u 17-20
            {
                id: 17,
                question: "What type of film is 'The Last Hero'?",
                options: ["A horror film", "A comedy", "A sci-fi film", "A documentary"],
                correct: 2,
                isReading: true
            },
            {
                id: 18,
                question: "Why did Lan decide to watch the film?",
                options: ["Because she loves sci-fi films.", "Because her favorite actor stars in it.", "Because the tickets were cheap.", "Because she had nothing to do."],
                correct: 1,
                isReading: true
            },
            {
                id: 19,
                question: "What did Lan think about the length of the film?",
                options: ["It was too short.", "It was just right.", "It was too long.", "It was confusing."],
                correct: 2,
                isReading: true
            },
            {
                id: 20,
                question: "Which word best describes Lan's feeling at the end of the film?",
                options: ["Excited", "Scared", "Tired", "Angry"],
                correct: 2,
                isReading: true
            }
        ];

        // ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
        // ‚ïë              KH√îNG C·∫¶N S·ª¨A CODE PH√çA D∆Ø·ªöI                      ‚ïë
        // ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

        // ===== STATE =====
        let state = { name: '', className: '', parentPhone: '', current: 0, answers: {}, submitted: false };
        let timeLeft = QUIZ_TIME;
        let startTime = null; // Th·ªùi ƒëi·ªÉm b·∫Øt ƒë·∫ßu l√†m b√†i
        let timerInterval = null;
        let countdownInterval = null;

        // ===== DOM =====
        const $ = id => document.getElementById(id);
        const lockedScreen = $('lockedScreen');
        const expiredScreen = $('expiredScreen');
        const completedScreen = $('completedScreen');
        const startScreen = $('startScreen');
        const quizScreen = $('quizScreen');
        const resultScreen = $('resultScreen');

        // ===== INIT =====
        document.addEventListener('DOMContentLoaded', () => {
            // Ki·ªÉm tra ƒë√£ ho√†n th√†nh ch∆∞a
            if (ONE_TIME_ONLY && checkCompleted()) {
                showScreen('completed');
                return;
            }
            checkSchedule();
            $('studentForm').onsubmit = handleStart;
            $('prevBtn').onclick = () => navigate(-1);
            $('nextBtn').onclick = () => navigate(1);
            $('submitBtn').onclick = handleSubmit;
        });

        // ===== CHECK COMPLETED (localStorage) =====
        function checkCompleted() {
            return localStorage.getItem(QUIZ_ID + '_completed') === 'true';
        }

        function markCompleted() {
            localStorage.setItem(QUIZ_ID + '_completed', 'true');
            localStorage.setItem(QUIZ_ID + '_completedAt', new Date().toISOString());
        }

        // ===== SCHEDULE CHECK =====
        function checkSchedule() {
            // N·∫øu schedule b·ªã t·∫Øt, lu√¥n hi·ªÉn th·ªã m√†n h√¨nh start
            if (!SCHEDULE_ENABLED) {
                showScreen('start');
                return;
            }
            const now = new Date();
            if (now < OPEN_TIME) { showScreen('locked'); startCountdown(); }
            else if (now > CLOSE_TIME) { showScreen('expired'); }
            else { showScreen('start'); }
        }

        function showScreen(screen) {
            lockedScreen.classList.add('hidden');
            expiredScreen.classList.add('hidden');
            completedScreen.classList.add('hidden');
            startScreen.classList.add('hidden');
            quizScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');

            if (screen === 'locked') lockedScreen.classList.remove('hidden');
            else if (screen === 'expired') expiredScreen.classList.remove('hidden');
            else if (screen === 'completed') completedScreen.classList.remove('hidden');
            else if (screen === 'start') startScreen.classList.remove('hidden');
            else if (screen === 'quiz') quizScreen.classList.remove('hidden');
            else if (screen === 'result') resultScreen.classList.remove('hidden');
        }

        function startCountdown() {
            updateCountdown();
            countdownInterval = setInterval(() => {
                const now = new Date();
                if (now >= OPEN_TIME) { clearInterval(countdownInterval); checkSchedule(); }
                else { updateCountdown(); }
            }, 1000);
        }

        function updateCountdown() {
            const now = new Date();
            const diff = OPEN_TIME - now;
            if (diff <= 0) return;

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            let display = '';
            if (days > 0) display += `${days} ng√†y `;
            display += `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            $('countdownDisplay').textContent = display;
        }

        function handleStart(e) {
            e.preventDefault();
            // Ki·ªÉm tra schedule n·∫øu ƒë∆∞·ª£c b·∫≠t
            if (SCHEDULE_ENABLED) {
                const now = new Date();
                if (now < OPEN_TIME || now > CLOSE_TIME) { checkSchedule(); return; }
            }

            state.name = $('studentName').value.trim();
            state.className = $('studentClass').value.trim();
            state.parentPhone = $('parentPhone').value.trim();

            if (!state.name || !state.className) return alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!');
            if (!state.parentPhone || !/^[0-9]{10,11}$/.test(state.parentPhone)) {
                return alert('Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i ph·ª• huynh h·ª£p l·ªá (10-11 s·ªë)!');
            }

            $('dispName').textContent = state.name;
            $('dispClass').textContent = 'L·ªõp ' + state.className;
            initNav();
            render();
            startTime = new Date(); // Ghi l·∫°i th·ªùi ƒëi·ªÉm b·∫Øt ƒë·∫ßu
            if (TIMER_ENABLED) {
                startTimer();
            } else {
                // Hi·ªÉn th·ªã ‚àû n·∫øu kh√¥ng gi·ªõi h·∫°n th·ªùi gian
                $('timerDisplay').textContent = '‚àû';
                $('timerBar').style.width = '100%';
            }
            showScreen('quiz');
        }

        // ===== TIMER =====
        function startTimer() {
            timeLeft = QUIZ_TIME;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) { clearInterval(timerInterval); autoSubmit(); }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            const display = $('timerDisplay');
            display.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            const percent = (timeLeft / QUIZ_TIME) * 100;
            $('timerBar').style.width = percent + '%';

            if (timeLeft <= 60) {
                display.className = 'text-2xl font-bold text-red-600 timer-warning';
                $('timerBar').className = 'h-full bg-gradient-to-r from-red-500 to-red-600 rounded-full transition-all duration-1000';
            } else if (timeLeft <= 180) {
                display.className = 'text-2xl font-bold text-amber-600';
                $('timerBar').className = 'h-full bg-gradient-to-r from-amber-500 to-orange-500 rounded-full transition-all duration-1000';
            }
        }

        function autoSubmit() {
            if (state.submitted) return;
            alert('‚è∞ H·∫øt gi·ªù! B√†i l√†m c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c t·ª± ƒë·ªông n·ªôp.');
            state.submitted = true;
            showResults();
        }

        function initNav() {
            const nav = $('questionNav');
            nav.innerHTML = '';
            quizData.forEach((_, i) => {
                const btn = document.createElement('button');
                btn.className = 'w-9 h-9 rounded-lg font-semibold text-sm border-2 border-gray-200 bg-white text-gray-600 hover:border-indigo-400 hover:bg-indigo-50 transition-all';
                btn.textContent = i + 1;
                btn.onclick = () => { state.current = i; render(); };
                nav.appendChild(btn);
            });
        }

        function updateNav() {
            Array.from($('questionNav').children).forEach((btn, i) => {
                btn.className = 'w-9 h-9 rounded-lg font-semibold text-sm border-2 transition-all ';
                if (i === state.current) btn.className += 'bg-indigo-600 text-white border-indigo-600';
                else if (state.answers[i] !== undefined) btn.className += 'bg-emerald-500 text-white border-emerald-500';
                else btn.className += 'bg-white text-gray-600 border-gray-200 hover:border-indigo-400 hover:bg-indigo-50';
            });
        }

        function render() {
            const q = quizData[state.current];
            const total = quizData.length;

            $('qNum').textContent = state.current + 1;
            $('qBadge').textContent = state.current + 1;
            $('currentQ').textContent = state.current + 1;
            $('questionText').textContent = q.question;
            $('progressBar').style.width = ((state.current + 1) / total * 100) + '%';

            // Show/hide reading passage for questions 17-20
            const readingContainer = $('readingPassageContainer');
            if (q.isReading) {
                readingContainer.classList.remove('hidden');
            } else {
                readingContainer.classList.add('hidden');
            }

            const container = $('optionsContainer');
            container.innerHTML = '';
            const letters = ['A', 'B', 'C', 'D'];

            q.options.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 flex items-center gap-4 bg-white';
                if (state.answers[state.current] === i) btn.classList.add('selected');
                btn.innerHTML = `<span class="flex-shrink-0 w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center font-bold text-gray-600">${letters[i]}</span><span class="font-medium text-gray-700">${opt}</span>`;
                btn.onclick = () => { if (!state.submitted) { state.answers[state.current] = i; render(); } };
                container.appendChild(btn);
            });

            $('prevBtn').disabled = state.current === 0;
            $('nextBtn').classList.toggle('hidden', state.current === total - 1);
            $('submitBtn').classList.toggle('hidden', state.current !== total - 1);
            updateNav();
        }

        function navigate(dir) {
            const newIdx = state.current + dir;
            if (newIdx >= 0 && newIdx < quizData.length) { state.current = newIdx; render(); }
        }

        function handleSubmit() {
            const answered = Object.keys(state.answers).length;
            if (answered < quizData.length && !confirm(`B·∫°n c√≤n ${quizData.length - answered} c√¢u ch∆∞a tr·∫£ l·ªùi. N·ªôp b√†i?`)) return;
            if (answered === quizData.length && !confirm('B·∫°n c√≥ ch·∫Øc mu·ªën n·ªôp b√†i?')) return;

            clearInterval(timerInterval);
            state.submitted = true;
            showResults();
        }

        function showResults() {
            let correct = 0;
            quizData.forEach((q, i) => { if (state.answers[i] === q.correct) correct++; });

            const total = quizData.length;
            const score = (correct / total * 10).toFixed(1);
            const percent = Math.round(correct / total * 100);

            $('scoreDisplay').textContent = score;
            $('correctCount').textContent = correct;
            $('incorrectCount').textContent = total - correct;
            $('percentDisplay').textContent = percent + '%';
            $('resultPhone').textContent = state.parentPhone;

            setTimeout(() => {
                document.querySelector('.score-circle').style.setProperty('--score-percent', (correct / total * 360) + 'deg');
            }, 100);

            const header = $('resultHeader');
            let title, msg, gradient;
            if (parseFloat(score) >= 9) { title = 'üèÜ Xu·∫•t s·∫Øc!'; msg = 'Tuy·ªát v·ªùi! B·∫°n ƒë√£ l√†m ch·ªß ki·∫øn th·ª©c!'; gradient = 'bg-gradient-to-br from-amber-400 to-orange-500'; createConfetti(); }
            else if (parseFloat(score) >= 7) { title = 'üåü Gi·ªèi l·∫Øm!'; msg = 'K·∫øt qu·∫£ r·∫•t t·ªët!'; gradient = 'bg-gradient-to-br from-emerald-400 to-teal-500'; }
            else if (parseFloat(score) >= 5) { title = 'üëç Kh√° t·ªët!'; msg = 'C·ªë g·∫Øng √¥n t·∫≠p th√™m nh√©!'; gradient = 'bg-gradient-to-br from-blue-400 to-indigo-500'; }
            else { title = 'üí™ C·∫ßn c·ªë g·∫Øng!'; msg = 'H√£y xem l·∫°i b√†i h·ªçc v√† th·ª≠ l·∫°i!'; gradient = 'bg-gradient-to-br from-pink-400 to-rose-500'; }

            $('resultTitle').textContent = title;
            $('resultMessage').textContent = msg;
            header.className = 'p-8 text-center ' + gradient;

            showScreen('result');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            sendToSheet(state.name, state.className, state.parentPhone, score);
        }

        function createConfetti() {
            const colors = ['#6366f1', '#8b5cf6', '#a855f7', '#ec4899', '#f43f5e', '#10b981', '#f59e0b'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const c = document.createElement('div');
                    c.className = 'confetti';
                    c.style.left = Math.random() * 100 + 'vw';
                    c.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    c.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(c);
                    setTimeout(() => c.remove(), 4000);
                }, i * 50);
            }
        }

        async function sendToSheet(name, className, parentPhone, score) {
            const status = $('submitStatus');
            status.textContent = '‚è≥ ƒêang g·ª≠i k·∫øt qu·∫£...';
            status.className = 'text-center mb-4 py-2 px-4 rounded-lg text-sm font-medium bg-blue-100 text-blue-700';

            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') {
                status.textContent = '‚ö†Ô∏è Ch∆∞a c·∫•u h√¨nh Google Sheets';
                status.className = 'text-center mb-4 py-2 px-4 rounded-lg text-sm font-medium bg-amber-100 text-amber-700';
                return;
            }

            // T√≠nh s·ªë c√¢u ƒë√∫ng v√† t·ªïng s·ªë c√¢u
            let correctCount = 0;
            quizData.forEach((q, i) => { if (state.answers[i] === q.correct) correctCount++; });
            const totalQuestions = quizData.length;

            // T√≠nh th·ªùi gian l√†m b√†i
            let timeSpent = 0;
            if (startTime) {
                timeSpent = Math.floor((new Date() - startTime) / 1000);
            } else if (TIMER_ENABLED) {
                timeSpent = QUIZ_TIME - timeLeft;
            }
            const minutes = Math.floor(timeSpent / 60);
            const seconds = timeSpent % 60;
            const timeSpentStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            // Chi ti·∫øt ƒë√°p √°n
            const answerDetails = quizData.map((q, i) => ({
                question: i + 1,
                userAnswer: q.options[state.answers[i]] || "Ch∆∞a tr·∫£ l·ªùi",
                correctAnswer: q.options[q.correct],
                isCorrect: state.answers[i] === q.correct
            }));

            try {
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name,
                        className,
                        parentPhone,
                        score,
                        correctCount,
                        totalQuestions,
                        timeSpent: timeSpentStr,
                        details: JSON.stringify(answerDetails)
                    })
                });
                status.textContent = '‚úÖ ƒê√£ l∆∞u k·∫øt qu·∫£ th√†nh c√¥ng!';
                status.className = 'text-center mb-4 py-2 px-4 rounded-lg text-sm font-medium bg-emerald-100 text-emerald-700';

                // ƒê√°nh d·∫•u ƒë√£ ho√†n th√†nh
                if (ONE_TIME_ONLY) {
                    markCompleted();
                }
            } catch (e) {
                status.textContent = '‚ö†Ô∏è Kh√¥ng th·ªÉ l∆∞u k·∫øt qu·∫£';
                status.className = 'text-center mb-4 py-2 px-4 rounded-lg text-sm font-medium bg-amber-100 text-amber-700';
            }
        }
    </script>
</body>

</html>